(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{8266:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return t(3029)}])},3029:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return eA}});var l=t(5893),n=t(7294),i=t(9008),r=t.n(i),a=t(6254),c=t(3990);let o=(0,c.IL)("globus.search.facets",[]);function d(e){var s,t;let l=null===(s=o.find(s=>s.name===e))||void 0===s?void 0:s.field_name;return l||(l=null===(t=o.find(s=>s.field_name===e))||void 0===t?void 0:t.field_name),l}function u(e,s){switch(s.type){case"set_limit":return{...e,limit:s.payload,offset:0};case"set_offset":return{...e,offset:s.payload};case"set_facet_filter":{let t=d(s.payload.facet.name),{facetFilters:l}=e;if(0===s.payload.value.length&&l[t]){let{[t]:s,...n}=l;return{...e,facetFilters:n}}return{...e,facetFilters:{...l,[t]:{type:"match_any",field_name:t,values:s.payload.value}}}}case"reset_facet_filters":return{...e,facetFilters:h.facetFilters};default:return e}}let h={limit:25,offset:0,facetFilters:{}},x=(0,n.createContext)(h),f=(0,n.createContext)(()=>{});function j(e){let{children:s}=e,[t,i]=(0,n.useReducer)(u,h);return(0,l.jsx)(x.Provider,{value:t,children:(0,l.jsx)(f.Provider,{value:i,children:s})})}function v(){return(0,n.useContext)(x)}function p(){return(0,n.useContext)(f)}var m=t(8029),g=t(8186),y=t(4296),_=t(9342),b=t(2206),k=t(5715),z=t(3636),C=t(8899),w=t(92),S=t(8573),F=t(3493),E=t.n(F),L=t(3279),I=t.n(L),O=t(624),Z=t(7024),N=t(406),J=t(1752),R=t(2553),A=t(608),D=t(2095),P=t(8488),q=t(7873),U=t(4302),T=t(1797),W=t(9366),B=t(6964),K=t(8329),X=t(4114),V=t(4032),M=t(5355),G=t(8118),H=t(3069),$=t(81),Q=t(1594);let Y=(0,c.IL)("globus.search.facets",[]),ee=["ArrowUp","ArrowDown","Escape"],es=e=>{let{role:s,...t}=(0,J.iX)(e);return(0,l.jsx)(m.x,{role:s,children:(0,l.jsxs)(y.B,{children:[(0,l.jsx)(_.Z,{pointerEvents:"none",children:(0,l.jsx)(R.J,{as:H.Z,color:"gray.300"})}),(0,l.jsx)(b.I,{placeholder:"Search",variant:"flush",...t,type:"search",onKeyDown:e=>{ee.includes(e.key)||e.stopPropagation()}})]})})};function et(e){var s,t;let{facet:i}=e,r=p(),a=v(),[c,o]=n.useState(""),u=d(i.name),h=(null===(s=a.facetFilters[u])||void 0===s?void 0:s.values)||[],x=e=>{r({type:"set_facet_filter",payload:{facet:i,value:Array.isArray(e)?e:[e]}})},f=c?null===(t=i.buckets)||void 0===t?void 0:t.filter(e=>-1!==JSON.stringify(e.value).toLowerCase().indexOf(c.toLowerCase())):i.buckets;return(0,l.jsxs)(A.v,{closeOnSelect:!1,autoSelect:!1,children:[(0,l.jsx)(D.j,{as:P.z,size:"sm",leftIcon:(0,l.jsx)(R.J,{as:$.Z}),variant:"ghost",border:"1px dashed",borderColor:"gray.400",p:1,children:(0,l.jsxs)(z.U,{children:[(0,l.jsx)(w.x,{children:i.name}),h.length>0&&h.length<=2&&h.map(e=>(0,l.jsx)(m.x,{children:(0,l.jsx)(q.Vp,{size:"sm",children:e})},e)),h.length>2&&(0,l.jsxs)(q.Vp,{size:"sm",children:[h.length," selected"]})]})}),(0,l.jsxs)(U.q,{p:0,children:[(0,l.jsx)(es,{isDisabled:(null==f?void 0:f.length)===0&&!c,onChange:e=>o(e.target.value)}),(null==f?void 0:f.length)===0&&(0,l.jsx)(T.s,{justifyContent:"center",isDisabled:!0,children:"No results found."}),(0,l.jsx)(W._,{onChange:x,value:h,type:"checkbox",children:null==f?void 0:f.map(e=>{let s="string"==typeof e.value?e.value:JSON.stringify(e.value);return(0,l.jsx)(B.i,{value:s,children:(0,l.jsxs)(K.k,{align:"center",children:[""===s?(0,l.jsx)(w.x,{as:"i",children:"(Not Set)"}):s,(0,l.jsx)(X.L,{}),(0,l.jsx)(V.C,{ml:2,children:e.count})]})},s)})}),h.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M.R,{}),(0,l.jsx)(T.s,{justifyContent:"center",onClick:()=>x([]),children:"Clear Filters"})]})]})]})}function el(e){let{result:s,...t}=e,n=p(),i=v();if(0===Y.length||!s||!s.facet_results)return null;let r=Object.keys(i.facetFilters).length>0;return(0,l.jsxs)(m.x,{...t,children:[(0,l.jsx)(G.E,{children:s.facet_results.map((e,s)=>(0,l.jsx)(G.U,{children:(0,l.jsx)(et,{facet:e})},s))}),r&&(0,l.jsx)(P.z,{mt:2,size:"xs",onClick:()=>{n({type:"reset_facet_filters"})},variant:"ghost",leftIcon:(0,l.jsx)(R.J,{as:Q.Z}),children:"Clear All Filters"})]})}var en=t(1664),ei=t.n(en),er=t(7167),ea=t(3416),ec=t(3491),eo=t(4703),ed=t(6007),eu=t(8663),eh=t(8779),ex=t(232),ef=t(7879),ej=t(4270),ev=t(8455),ep=t(5112),em=t(1437),eg=t(6554),ey=t(2186);function e_(e){let{field:s,gmeta:t}=e,[i,r]=n.useState();return((0,n.useEffect)(()=>{(0,ep.l_)(s,t).then(e=>{r(e)})},[s,t]),i)?(0,l.jsxs)(er.Tr,{children:[(0,l.jsx)(ea.Td,{children:i.label}),(0,l.jsx)(ea.Td,{children:(0,l.jsx)(ep.GH,{field:i})})]}):null}function eb(e){let{fields:s,gmeta:t}=e;return s&&0!==s.length?(0,l.jsx)(ec.x,{children:(0,l.jsx)(eo.i,{size:"sm",children:(0,l.jsx)(ed.p,{children:s.map((e,s)=>(0,l.jsx)(e_,{field:e,gmeta:t},s))})})}):null}function ek(e){let{gmeta:s}=e,[t,i]=n.useState(),[r,a]=n.useState(),[o,d]=n.useState(),[u,h]=n.useState(!0);(0,n.useEffect)(()=>{!async function(){let e=await (0,c.oK)(s,"components.ResultListing.heading"),t=await (0,c.oK)(s,"components.ResultListing.summary"),l=await (0,c.oK)(s,"components.ResultListing.image");i(e),a(t),"string"==typeof l&&(l={src:l}),d(l),h(!1)}()},[s]);let x=(0,c.IL)("components.ResultListing.fields");return(0,l.jsxs)(eu.Z,{size:"sm",w:"full",children:[(0,l.jsx)(eh.O,{style:{textWrap:"stable"},children:(0,l.jsx)(ex.X,{size:"md",wordBreak:"break-word",children:(0,l.jsx)(ef.r,{as:ei(),href:(0,ey.E)(s.subject),children:(0,l.jsx)(ej.O,{isLoaded:!u,children:t||(0,l.jsx)(w.x,{as:"em",color:"gray.500",children:"â€”"})})})})}),(0,l.jsxs)(ev.e,{children:[(0,l.jsx)(eg.Z,{result:s,size:"xs",mb:2}),o||r||x?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(z.U,{children:[o&&(0,l.jsx)(em.Z,{value:{src:o.src,alt:null==o?void 0:o.alt}}),r&&(0,l.jsx)(w.x,{noOfLines:[3,5,10],children:r})]}),(0,l.jsx)(eb,{fields:x,gmeta:s})]}):null]})]})}var ez=t(9715),eC=t(243),ew=t(6071),eS=t(5856),eF=t(2873),eE=t(749);let eL=e=>{let{result:s}=e,t=v(),n=p();return s?(0,l.jsxs)(K.k,{align:"center",p:2,children:[(0,l.jsxs)(z.U,{children:[(0,l.jsx)(w.x,{fontSize:"sm",as:"label",htmlFor:"limit",children:"Results per page:"}),(0,l.jsx)(m.x,{children:(0,l.jsxs)(eC.P,{id:"limit",size:"sm",value:t.limit,onChange:e=>{n({type:"set_limit",payload:parseInt(e.target.value)})},children:[(0,l.jsx)("option",{value:10,children:"10"}),(0,l.jsx)("option",{value:25,children:"25"}),(0,l.jsx)("option",{value:50,children:"50"}),(0,l.jsx)("option",{value:100,children:"100"})]})})]}),(0,l.jsx)(X.L,{}),(0,l.jsxs)(w.x,{fontSize:"xs",mr:2,children:[(0,l.jsxs)(w.x,{as:"b",children:[t.offset>0?t.offset:1,"-",Math.min(t.offset+t.limit,s.total)]})," ","of ",(0,l.jsx)(w.x,{as:"b",children:s.total})]}),(0,l.jsxs)(ew.h,{variant:"outline",spacing:"2",children:[(0,l.jsx)(P.z,{size:"sm",isDisabled:0===t.offset,onClick:()=>{n({type:"set_offset",payload:0})},children:(0,l.jsx)(R.J,{as:eS.Z})}),(0,l.jsx)(P.z,{size:"sm",isDisabled:0===t.offset,onClick:()=>{n({type:"set_offset",payload:t.offset-t.limit})},children:(0,l.jsx)(R.J,{as:eF.Z})}),(0,l.jsx)(P.z,{size:"sm",isDisabled:t.offset+t.limit>=s.total,onClick:()=>{n({type:"set_offset",payload:t.offset+t.limit})},children:(0,l.jsx)(R.J,{as:eE.Z})})]})]}):null};var eI=t(9332),eO=t(1163);let eZ=(0,c.IL)("globus.search.index"),eN=(0,c.IL)("globus.search.facets",[]);function eJ(){var e,s,t,i;let r=(0,Z.qk)(),a=(0,eO.useRouter)(),o=v(),d=(0,eI.useSearchParams)().get("q")||"",[u,h]=(0,n.useState)(d),[x,f]=(0,n.useState)(),[j,p]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=E()(async()=>{var e,s,t;p(!0);let l=c.EC&&r.isAuthenticated&&(null===(t=r.authorization)||void 0===t?void 0:null===(s=t.tokens)||void 0===s?void 0:null===(e=s.search)||void 0===e?void 0:e.access_token)?{Authorization:"Bearer ".concat(r.authorization.tokens.search.access_token)}:void 0,n=await O.yC.IO.post(eZ,{payload:{q:u,facets:eN,offset:o.offset,limit:o.limit,filters:Object.values(o.facetFilters).filter(e=>!!e)},headers:l});f(await n.json()),p(!1)},1e3);return e(),()=>e.cancel()},[u,o,c.EC?null===(t=r.authorization)||void 0===t?void 0:null===(s=t.tokens)||void 0===s?void 0:null===(e=s.search)||void 0===e?void 0:e.access_token:void 0]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.x,{py:2,position:"sticky",top:0,backgroundColor:"white",zIndex:1,children:(0,l.jsxs)(g.g,{spacing:2,align:"stretch",children:[(0,l.jsxs)(y.B,{size:"md",children:[(0,l.jsx)(_.Z,{pointerEvents:"none",children:(0,l.jsx)(S.W,{color:"gray.300"})}),(0,l.jsx)(b.I,{defaultValue:d,type:"search",placeholder:"Start your search here...",onChange:I()(e=>{a.push({query:{q:e.target.value}}),h(e.target.value)},300)})]}),(0,l.jsx)(el,{result:x}),(0,l.jsx)(eL,{result:x}),j&&(0,l.jsx)(k.M,{children:(0,l.jsxs)(z.U,{children:[(0,l.jsx)(C.$,{size:"sm"})," ",(0,l.jsx)(w.x,{fontSize:"sm",children:"Fetching results..."})]})})]})}),(0,l.jsx)(m.x,{children:(0,l.jsxs)(m.x,{p:4,children:[(0,N.W)(x)&&(0,l.jsx)(ez.j,{error:x}),x&&x.total>0&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(g.g,{py:2,spacing:5,align:"stretch",children:null===(i=x.gmeta)||void 0===i?void 0:i.map((e,s)=>(0,l.jsx)(ek,{gmeta:e},e.subject))})}),x&&0===x.total&&(0,l.jsx)(m.x,{children:"No datasets found."})]})})]})}var eR=t(6240);function eA(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r(),{children:(0,l.jsxs)("title",{children:[c.IS.title," | Search"]})}),(0,l.jsx)(a.W,{maxW:"container.xl",children:(0,l.jsx)("main",{children:(0,l.jsx)(eR.w,{children:(0,l.jsx)(j,{children:(0,l.jsx)(eJ,{})})})})})]})}}},function(e){e.O(0,[552,13,140,791,888,774,179],function(){return e(e.s=8266)}),_N_E=e.O()}]);