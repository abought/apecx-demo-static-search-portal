(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[117],{6242:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/transfer",function(){return t(1779)}])},1779:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Q}});var n=t(5893),i=t(7294),r=t(6459),a=t(5715),l=t(92),o=t(8329),c=t(4114),d=t(7879),h=t(2553),u=t(6254),x=t(6657),j=t(8843),f=t(9915),p=t(8029),m=t(232),v=t(1089),b=t(8663),g=t(8779),y=t(8455),_=t(3712),w=t(90),z=t(8186),k=t(4506),S=t(980),T=t(2206),C=t(8488),A=t(7967),D=t(624),E=t(7024),I=t(4675),N=t(4296),O=t(9342),q=t(7539),W=t(2867),L=t(3069);function P(e){let{value:s=null,onSelect:t=()=>{}}=e,r=(0,E.qk)(),[a,o]=(0,i.useState)([]),[c,d]=(0,i.useState)(s);async function u(e){let s=e.currentTarget.value;if(!s){o([]);return}let t=await D.re.endpointSearch({query:{filter_fulltext:s,limit:20}},{manager:r.authorization});if(!t.ok){console.error("Error searching for endpoints:",t);return}o((await t.json()).DATA)}return((0,i.useEffect)(()=>{d(s),null===s&&o([])},[s]),c)?(0,n.jsxs)(N.B,{children:[(0,n.jsx)(T.I,{value:c.display_name||c.name,readOnly:!0}),(0,n.jsx)(O.x,{width:"4.5rem",children:(0,n.jsx)(C.z,{h:"1.75rem",size:"sm",onClick:()=>d(null),children:"Clear"})})]}):(0,n.jsxs)(_.K,{children:[(0,n.jsx)(p.x,{position:"sticky",top:"0",zIndex:1,bgColor:"white",children:(0,n.jsxs)(N.B,{children:[(0,n.jsx)(T.I,{onInput:e=>u(e),placeholder:"e.g. Globus Tutorial Collection"}),(0,n.jsx)(q.xW,{children:(0,n.jsx)(h.J,{as:L.Z})})]})}),(0,n.jsx)(_.K,{maxH:"400px",overflowY:"auto",children:a.map(e=>(0,n.jsxs)(b.Z,{size:"sm",variant:"outline",onClick:()=>{d(e),t(e)},_hover:{cursor:"pointer",borderColor:"blue.500"},children:[(0,n.jsxs)(g.O,{pb:0,children:[(0,n.jsx)(l.x,{children:e.display_name||e.name}),(0,n.jsx)(l.x,{fontSize:"xs",children:e.entity_type})]}),(0,n.jsx)(y.e,{children:(0,n.jsxs)(W.aV,{fontSize:"xs",children:[(0,n.jsxs)(W.HC,{children:["ID: ",e.id]}),(0,n.jsxs)(W.HC,{children:["Owner: ",e.owner_id]}),(0,n.jsxs)(W.HC,{children:["Domain: ",e.domain||"—"]}),(0,n.jsx)(W.HC,{children:(0,n.jsxs)(l.x,{noOfLines:1,children:["Description: ",e.description||"—"]})})]})})]},e.id))})]})}var X=t(3990),Z=t(8899),F=t(6972),H=t(1429),J=t(5167),K=t(4222),G=t(972);function M(e){let{path:s,collectionId:t}=e,r=(0,E.qk)(),a=(0,G.m)(),[c,d]=i.useState(!1),[u,f]=i.useState(null),[m,v]=i.useState(),[b,g]=i.useState(!1);if((0,i.useEffect)(()=>{(async function(){if(!t||!s)return;d(!0);let e=await D.re.fileOperations.stat(t,{query:{path:s}},{manager:r.authorization}),n=await e.json();v(n),((0,K.OF)(n)||(0,K.kJ)(n))&&g(!0),f(e.ok),d(!1)})()},[r.authorization,s,t]),s&&t)return b?(0,n.jsxs)(x.b,{status:"error",children:[(0,n.jsx)(j.z,{}),(0,n.jsx)(w.X,{children:"An error was encountered trying to access the provided path."}),(0,n.jsx)(p.x,{children:(0,n.jsx)(C.z,{ml:2,size:"xs",onClick:async()=>{var e;m&&(a.setReplaceWith("/transfer"),await (null===(e=r.authorization)||void 0===e?void 0:e.handleErrorResponse(m)))},children:"Address"})})]}):(0,n.jsx)(z.g,{align:"start",children:(0,n.jsxs)(o.k,{alignItems:"center",children:[c?(0,n.jsx)(Z.$,{mr:1}):u?(0,n.jsx)(h.J,{as:H.Z,mr:1,boxSize:6}):(0,n.jsx)(h.J,{as:J.Z,mr:1,boxSize:6}),!c&&u?(0,n.jsx)(l.x,{children:"Path exists on destination."}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(F.u,{hasArrow:!0,label:"We've attempted to reach the path you provided, but were unsuccessful. This might be intentional, or there might be a typo in your desired path.",placement:"bottom",children:(0,n.jsx)(l.x,{cursor:"help",textDecor:"underline",textDecorationStyle:"dashed",children:"Unable to access path on destination."})})})]})})}var Y=t(8746),B=t(8332);function Q(){var e,s,t,i,N,O,q,W,L;let Z=(0,E.qk)(),F=(0,r.p)(),H=(0,I.q)();if(!1===X._t)return(0,n.jsx)(a.M,{my:5,children:(0,n.jsx)(l.x,{fontSize:"xl",children:"Globus Transfer functionality is not available in this portal."})});let J=H.items.reduce((e,s)=>(e[s.collection]||(e[s.collection]=[]),e[s.collection].push(s),e),{}),K=Object.keys(J),G=K.length>1;async function Q(e){var s;e.preventDefault();let{destination:t,path:i,label:r}=null!==(s=H.transfer)&&void 0!==s?s:{};i&&t&&K.forEach(async e=>{let s=await (await D.re.taskSubmission.submissionId({},{manager:Z.authorization})).json(),a=i.endsWith("/")?i:"".concat(i,"/"),l=await D.re.taskSubmission.submitTransfer({payload:{submission_id:s.value,label:r,source_endpoint:e,destination_endpoint:t.id,DATA:J[e].map(e=>({DATA_TYPE:"transfer_item",source_path:e.path,destination_path:"".concat(a).concat(e.path),recursive:"directory"===e.type}))}},{manager:Z.authorization}),u=await l.json();l.ok?(H.resetTransferSettings(),F({title:"Transfer: ".concat(u.code),description:(0,n.jsxs)(n.Fragment,{children:[u.message,"task_id"in u&&(0,n.jsxs)(o.k,{children:[(0,n.jsx)(c.L,{}),(0,n.jsxs)(d.r,{href:D.Ql.urlFor("TASK",[u.task_id]).toString(),isExternal:!0,children:["View task in Globus Web App"," ",(0,n.jsx)(h.J,{as:A.Z})]})]})]}),status:"success",isClosable:!0})):F({title:"Error (".concat(u.code,")"),description:u.message,status:"error",isClosable:!0})})}return(0,n.jsxs)(u.W,{maxW:"container.xl",p:4,children:[!1===Z.isAuthenticated&&(0,n.jsxs)(x.b,{status:"error",my:2,children:[(0,n.jsx)(j.z,{}),(0,n.jsx)(f.C,{children:"You must authenticate to initiate a transfer."})]}),0===H.items.length?(0,n.jsx)(a.M,{children:(0,n.jsx)(l.x,{fontSize:"xl",children:"No items in the Transfer List."})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.x,{mb:8,children:[(0,n.jsx)(m.X,{size:"lg",my:4,children:"Transfer Data"}),(0,n.jsx)(l.x,{fontSize:"lg",children:"Now that you have selected the data for transfer, you'll need to specify a destination collection, path, and optional label for the transfer."})]}),(0,n.jsxs)(v.M,{columns:2,spacing:10,children:[(0,n.jsx)(p.x,{children:K.map((e,s)=>(0,n.jsxs)(b.Z,{size:"sm",children:[(0,n.jsx)(g.O,{children:(0,n.jsxs)(o.k,{children:[(0,n.jsx)(m.X,{size:"sm",children:(0,n.jsx)(Y.v,{id:e})}),(0,n.jsx)(c.L,{})]})}),(0,n.jsx)(y.e,{children:(0,n.jsx)(_.K,{children:J[e].map(e=>(0,n.jsx)(B.q,{item:e},e.subject))})})]},e))}),(0,n.jsxs)(p.x,{children:[G&&(0,n.jsxs)(x.b,{status:"info",my:2,children:[(0,n.jsx)(j.z,{}),(0,n.jsxs)(w.X,{children:["Since the data you've selected is hosted across multiple sources (",K.length,"), a transfer task will be created for each source."]})]}),(0,n.jsx)("form",{onSubmit:e=>Q(e),children:(0,n.jsx)("fieldset",{disabled:!Z.isAuthenticated,children:(0,n.jsxs)(z.g,{children:[(0,n.jsxs)(k.NI,{children:[(0,n.jsx)(S.l,{children:"Destination"}),(0,n.jsx)(P,{value:null!==(L=null===(e=H.transfer)||void 0===e?void 0:e.destination)&&void 0!==L?L:null,onSelect:e=>{H.setDestination(e)}})]}),(0,n.jsxs)(k.NI,{children:[(0,n.jsx)(S.l,{children:"Path"}),(0,n.jsx)(T.I,{value:(null===(s=H.transfer)||void 0===s?void 0:s.path)||"",required:!0,disabled:!Z.isAuthenticated,onChange:e=>{H.setPath(e.currentTarget.value)}}),(0,n.jsx)(k.Q6,{children:(null===(t=H.transfer)||void 0===t?void 0:t.path)&&(0,n.jsx)(M,{path:H.transfer.path,collectionId:null===(N=H.transfer)||void 0===N?void 0:null===(i=N.destination)||void 0===i?void 0:i.id})})]}),(0,n.jsxs)(k.NI,{children:[(0,n.jsx)(S.l,{children:"Label"}),(0,n.jsx)(T.I,{value:(null===(O=H.transfer)||void 0===O?void 0:O.label)||"",disabled:!Z.isAuthenticated,onChange:e=>{H.setLabel(e.currentTarget.value)}})]}),(0,n.jsx)(C.z,{w:"100%",isDisabled:!(null===(q=H.transfer)||void 0===q?void 0:q.destination)||!(null===(W=H.transfer)||void 0===W?void 0:W.path),type:"submit",children:"Start Transfer"})]})})})]})]})]})]})}}},function(e){e.O(0,[978,888,774,179],function(){return e(e.s=6242)}),_N_E=e.O()}]);